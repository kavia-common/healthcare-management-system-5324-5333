{"is_source_file": true, "format": "Python", "description": "This file defines FastAPI API endpoints related to authentication operations such as user registration, login, token refresh, logout, and retrieving current user info. It includes route handlers that interact with a MongoDB database and security functions for password hashing and token creation.", "external_files": ["src.core.security", "src.db.mongo", "src.models.auth", "src.models.user", "src.models.patient", "src.core.deps", "jose", "src.core.config"], "external_methods": ["get_password_hash", "verify_password", "create_access_token", "create_refresh_token", "get_db", "Token.model_validate", "UserPublic.model_validate", "UserInDB.model_dump", "get_current_user"], "published": ["router"], "classes": [{"name": "Token", "description": "Data model for authentication tokens, including access and refresh tokens."}, {"name": "TokenRefreshRequest", "description": "Model for requesting a token refresh, containing the refresh token."}, {"name": "LoginRequest", "description": "Model capturing login credentials (likely username and password)."}, {"name": "UserCreate", "description": "Model for creating a new user, including email, full name, password, and role."}, {"name": "UserInDB", "description": "User model representing stored user data in the database."}, {"name": "UserPublic", "description": "Public user profile model returned by various endpoints."}, {"name": "Role", "description": "Enum or model defining user roles, e.g., patient."}, {"name": "PatientCreate", "description": "Model for patient profile creation."}, {"name": "PatientPublic", "description": "Public patient profile model."}], "methods": [{"name": "register_user(payload: UserCreate)", "description": "Registers a new user with role 'patient', creates associated patient profile, and returns public user info.", "scope": "", "scopeKind": ""}, {"name": "login(form_data: OAuth2PasswordRequestForm = Depends())", "description": "Authenticates a user using email and password, and returns access and refresh tokens.", "scope": "", "scopeKind": ""}, {"name": "refresh(payload: TokenRefreshRequest)", "description": "Validates a refresh token and issues new access and refresh tokens.", "scope": "", "scopeKind": ""}, {"name": "logout(_: UserInDB = Depends(get_current_user))", "description": "Performs stateless logout, instructing client to discard tokens.", "scope": "", "scopeKind": ""}, {"name": "whoami(current_user: UserInDB = Depends(get_current_user))", "description": "Returns current user's public profile information.", "scope": "", "scopeKind": ""}], "calls": ["get_password_hash", "verify_password", "create_access_token", "create_refresh_token", "get_db", "Token.model_validate", "UserPublic.model_validate", "UserInDB.model_dump", "get_current_user", "jwt.decode"], "search-terms": ["auth", "token", "login", "register", "refresh", "logout", "whoami", "OAuth2PasswordRequestForm", "mongo", "JWT", "FastAPI"], "state": 2, "file_id": 16, "knowledge_revision": 34, "git_revision": "", "ctags": [{"_type": "tag", "name": "login", "path": "/home/kavia/workspace/code-generation/healthcare-management-system-5324-5333/fastapi_backend/src/routers/auth.py", "pattern": "/^async def login(form_data: OAuth2PasswordRequestForm = Depends()):$/", "language": "Python", "kind": "function", "signature": "(form_data: OAuth2PasswordRequestForm = Depends())"}, {"_type": "tag", "name": "logout", "path": "/home/kavia/workspace/code-generation/healthcare-management-system-5324-5333/fastapi_backend/src/routers/auth.py", "pattern": "/^async def logout(_: UserInDB = Depends(get_current_user)):$/", "language": "Python", "kind": "function", "signature": "(_: UserInDB = Depends(get_current_user))"}, {"_type": "tag", "name": "refresh", "path": "/home/kavia/workspace/code-generation/healthcare-management-system-5324-5333/fastapi_backend/src/routers/auth.py", "pattern": "/^async def refresh(payload: TokenRefreshRequest):$/", "language": "Python", "kind": "function", "signature": "(payload: TokenRefreshRequest)"}, {"_type": "tag", "name": "register_user", "path": "/home/kavia/workspace/code-generation/healthcare-management-system-5324-5333/fastapi_backend/src/routers/auth.py", "pattern": "/^async def register_user(payload: UserCreate):$/", "language": "Python", "kind": "function", "signature": "(payload: UserCreate)"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/healthcare-management-system-5324-5333/fastapi_backend/src/routers/auth.py", "pattern": "/^router = APIRouter()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "whoami", "path": "/home/kavia/workspace/code-generation/healthcare-management-system-5324-5333/fastapi_backend/src/routers/auth.py", "pattern": "/^async def whoami(current_user: UserInDB = Depends(get_current_user)):$/", "language": "Python", "kind": "function", "signature": "(current_user: UserInDB = Depends(get_current_user))"}], "hash": "6b4d5c69d7303dc6a8de5b6487eddfc8", "format-version": 4, "code-base-name": "fastapi_backend", "filename": "fastapi_backend/src/routers/auth.py", "fields": [{"name": "router = APIRouter()", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"34": ""}]}