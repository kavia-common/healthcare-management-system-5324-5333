{"is_source_file": true, "format": "Python", "description": "This file contains dependency functions for user authentication and authorization in a FastAPI-based healthcare management system. It includes functions to get the current user from a JWT token and to enforce role-based access control.", "external_files": ["src.core.security.oauth2_scheme", "src.core.security.decode_token", "src.db.mongo.get_db", "src.models.user.UserInDB", "src.models.user.Role"], "external_methods": ["Depends", "HTTPException", "status.HTTP_401_UNAUTHORIZED", "status.HTTP_403_FORBIDDEN", "decode_token", "get_db", "UserInDB.model_validate"], "published": ["get_current_user", "require_roles"], "classes": [{"name": "UserInDB", "description": "Represents a user object retrieved from the database, including validation methods."}, {"name": "Role", "description": "Enumeration or class representing user roles."}], "methods": [{"name": "UserInDB get_current_user(token: str = Depends(oauth2_scheme))", "description": "Dependency function to retrieve and validate the current user based on JWT token.", "scope": "", "scopeKind": ""}, {"name": "require_roles(*roles: Role)", "description": "Factory function that creates dependencies to enforce role-based access control.", "scope": "", "scopeKind": ""}, {"name": "UserInDB _checker(user: UserInDB = Depends(get_current_user))", "scope": "require_roles", "scopeKind": "function", "description": "unavailable"}], "calls": ["decode_token", "get_db", "ObjectId", "UserInDB.model_validate", "Depends", "HTTPException"], "search-terms": ["FastAPI dependencies", "JWT authentication", "role-based access control", "get_current_user", "deps.py"], "state": 2, "file_id": 7, "knowledge_revision": 53, "git_revision": "", "revision_history": [{"16": ""}, {"53": ""}], "ctags": [{"_type": "tag", "name": "_checker", "path": "/home/kavia/workspace/code-generation/healthcare-management-system-5324-5333/fastapi_backend/src/core/deps.py", "pattern": "/^    async def _checker(user: UserInDB = Depends(get_current_user)) -> UserInDB:$/", "file": true, "language": "Python", "typeref": "typename:UserInDB", "kind": "function", "signature": "(user: UserInDB = Depends(get_current_user))", "scope": "require_roles", "scopeKind": "function"}, {"_type": "tag", "name": "get_current_user", "path": "/home/kavia/workspace/code-generation/healthcare-management-system-5324-5333/fastapi_backend/src/core/deps.py", "pattern": "/^async def get_current_user(token: str = Depends(oauth2_scheme)) -> UserInDB:$/", "language": "Python", "typeref": "typename:UserInDB", "kind": "function", "signature": "(token: str = Depends(oauth2_scheme))"}, {"_type": "tag", "name": "require_roles", "path": "/home/kavia/workspace/code-generation/healthcare-management-system-5324-5333/fastapi_backend/src/core/deps.py", "pattern": "/^def require_roles(*roles: Role):$/", "language": "Python", "kind": "function", "signature": "(*roles: Role)"}], "hash": "64392b2c8313a71f9d7e19d0e99fd97d", "format-version": 4, "code-base-name": "fastapi_backend", "filename": "fastapi_backend/src/core/deps.py"}